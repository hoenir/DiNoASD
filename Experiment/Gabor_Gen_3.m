function [IM] = Gabor_Gen_3(imsize, W_x, W_y, freq, phase, back_lum, orientation, contrast);IM = zeros(imsize);theta = -orientation/180*pi;X_vector = linspace(-imsize/2, imsize/2, imsize);for r = 1:imsize; % rows      y_1 = r - (imsize + 1)/2;   x_1 = X_vector;      x = cos(-theta) * x_1 + sin(-theta) * y_1;   y = -sin(-theta) * x_1 + cos(-theta) * y_1;      deel_x = exp(-2.77/W_x^2 *(x - 0).^2);   deel_y = exp(-2.77/W_y^2 *(y - 0).^2);      deel_f = cos(2*pi*freq* (x - 0) + phase);       temp = contrast*(deel_x.*deel_y.*deel_f);   temp_2 = 1+temp;   temp_3 = back_lum * temp_2;   IM(r, :) = temp_3;end